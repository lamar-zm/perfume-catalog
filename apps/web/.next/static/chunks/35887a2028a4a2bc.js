(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,19528,e=>{"use strict";var i=e.i(43476),r=e.i(71645),l=e.i(77936),s=e.i(92181),a=e.i(26200),n=e.i(33372),t=e.i(45288),o=e.i(73404),c=e.i(73990),d=e.i(5948),u=e.i(55150),h=e.i(94229),x=e.i(5142),g=e.i(53917),m=e.i(17708),p=e.i(57162),j=e.i(57662),b=e.i(48239);e.i(29499);var T=e.i(94108);e.i(6773);var f=e.i(64427),v=e.i(29277),y=e.i(25293),w=e.i(29895),z=e.i(44662),S=e.i(8010),I=e.i(41638),C=e.i(2564),P=e.i(92859),k=e.i(37716),A=e.i(82819),E=e.i(57772);function B({opened:e,onClose:s,brand:t,onSuccess:o}){let[d,u]=(0,r.useState)(!1),[x,g]=(0,r.useState)(!1),[m,p]=(0,r.useState)(null),j=(0,I.useForm)({initialValues:{name:"",slug:"",description:"",image:""},validate:{name:e=>e.trim().length<2?"الاسم يجب أن يكون 2 أحرف على الأقل":null,slug:e=>e.trim().length<2?"الرابط يجب أن يكون 2 أحرف على الأقل":null}});(0,r.useEffect)(()=>{e&&(t?(j.setValues({name:t.name,slug:t.slug,description:t.description||"",image:t.image||""}),p(t.image||null)):(j.reset(),p(null)))},[e,t]);let b=async e=>{if(e.length>0){let i=e[0];g(!0);try{let e=await T.uploadApi.upload(i);e.success&&e.data?(j.setFieldValue("image",e.data.url),p(e.data.url)):console.error("Upload failed:",e.error)}catch(e){console.error("Error uploading image:",e)}finally{g(!1)}}},f=async()=>{let e=j.values.image;if(e&&e.startsWith("/uploads/"))try{await T.uploadApi.delete(e)}catch(e){console.error("Error deleting image:",e)}p(null),j.setFieldValue("image","")},B=async e=>{u(!0);try{let i,r={name:e.name,slug:e.slug,description:e.description||void 0,image:e.image||""};(i=t?await T.brandApi.update(t.id,r):await T.brandApi.create(r)).success?o():console.error("Error saving brand:",i.error)}catch(e){console.error("Error saving brand:",e)}finally{u(!1)}};return(0,i.jsx)(v.Modal,{opened:e,onClose:s,title:t?"تعديل الماركة":"إضافة ماركة جديدة",size:"lg",children:(0,i.jsxs)(z.Box,{pos:"relative",children:[(0,i.jsx)(S.LoadingOverlay,{visible:x,zIndex:1e3,overlayProps:{blur:2}}),(0,i.jsx)("form",{onSubmit:j.onSubmit(B),children:(0,i.jsxs)(l.Stack,{gap:"md",children:[(0,i.jsxs)(z.Box,{children:[(0,i.jsx)(h.Text,{size:"sm",fw:500,mb:"xs",children:"صورة الماركة"}),m?(0,i.jsxs)(z.Box,{pos:"relative",children:[(0,i.jsx)(c.Image,{src:m,alt:"Preview",height:150,radius:"md",fallbackSrc:T.imageHelper.getPlaceholder(400,150)}),(0,i.jsx)(n.Button,{variant:"filled",color:"red",size:"xs",pos:"absolute",top:10,right:10,onClick:f,children:(0,i.jsx)(E.IconX,{size:16})})]}):(0,i.jsx)(C.Dropzone,{onDrop:b,accept:P.IMAGE_MIME_TYPE,maxSize:0xa00000,multiple:!1,loading:x,children:(0,i.jsxs)(a.Group,{justify:"center",gap:"xl",mih:120,style:{pointerEvents:"none"},children:[(0,i.jsx)(C.Dropzone.Accept,{children:(0,i.jsx)(k.IconUpload,{size:40,stroke:1.5})}),(0,i.jsx)(C.Dropzone.Reject,{children:(0,i.jsx)(E.IconX,{size:40,stroke:1.5})}),(0,i.jsx)(C.Dropzone.Idle,{children:(0,i.jsx)(A.IconPhoto,{size:40,stroke:1.5})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(h.Text,{size:"md",inline:!0,children:"اسحب الصورة هنا أو اضغط للاختيار"}),(0,i.jsx)(h.Text,{size:"sm",c:"dimmed",inline:!0,mt:7,children:"الحد الأقصى للحجم 10MB"})]})]})})]}),(0,i.jsx)(y.TextInput,{label:"اسم الماركة",placeholder:"أدخل اسم الماركة",required:!0,value:j.values.name,onChange:e=>{var i;let r;return i=e.target.value,j.setFieldValue("name",i),void(!t&&j.setFieldValue("slug",(r={شانيل:"chanel",ديور:"dior",قوتشي:"gucci",برادا:"prada",فيرساتشي:"versace",أرماني:"armani",جيفنشي:"givenchy",بولغاري:"bvlgari",هيرميس:"hermes","توم فورد":"tom-ford","كريستيان ديور":"christian-dior","ايف سان لوران":"yves-saint-laurent","كارولينا هيريرا":"carolina-herrera","جورجيو أرماني":"giorgio-armani","دولتشي آند غابانا":"dolce-gabbana","كالفن كلاين":"calvin-klein","هوغو بوس":"hugo-boss",عجمل:"ajmal","العربية للعود":"arabian-oud",رسايس:"rasasi","سويس أريبيان":"swiss-arabian",لطافة:"lattafa"})[i]?r[i]:i.toLowerCase().replace(/\s+/g,"-").replace(/[^\u0600-\u06FFa-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-|-$/g,"")))},error:j.errors.name}),(0,i.jsx)(y.TextInput,{label:"الرابط (Slug)",placeholder:"brand-slug",description:"يستخدم في الروابط - سيتم إنشاؤه تلقائياً",required:!0,dir:"ltr",...j.getInputProps("slug")}),(0,i.jsx)(w.Textarea,{label:"الوصف",placeholder:"أدخل وصف الماركة (اختياري)",minRows:2,...j.getInputProps("description")}),(0,i.jsxs)(a.Group,{justify:"flex-end",mt:"md",children:[(0,i.jsx)(n.Button,{variant:"light",onClick:s,children:"إلغاء"}),(0,i.jsx)(n.Button,{type:"submit",loading:d,children:t?"تحديث":"إضافة"})]})]})})]})})}var M=e.i(47215);function D(){let[e,v]=(0,r.useState)(!0),[y,w]=(0,r.useState)([]),[z,S]=(0,r.useState)(null),[I,C]=(0,r.useState)(null),[P,{open:k,close:A}]=(0,x.useDisclosure)(!1),[E,{open:D,close:F}]=(0,x.useDisclosure)(!1);(0,r.useEffect)(()=>{V()},[]);let V=async()=>{v(!0);try{let e=await T.brandApi.getAll();e.success&&e.data&&w(e.data)}catch(e){console.error("Error loading brands:",e)}finally{v(!1)}},G=async()=>{if(I)try{let e=await T.brandApi.delete(I.id);if(e.success)g.notifications.show({title:"تم الحذف",message:"تم حذف الماركة بنجاح",color:"green"}),V();else throw Error(e.error)}catch(e){g.notifications.show({title:"خطأ",message:"حدث خطأ أثناء حذف الماركة",color:"red"})}finally{F(),C(null)}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.Stack,{gap:"lg",children:[(0,i.jsxs)(a.Group,{justify:"space-between",children:[(0,i.jsx)(s.Title,{order:2,children:"إدارة الماركات"}),(0,i.jsx)(n.Button,{leftSection:(0,i.jsx)(m.IconPlus,{size:18}),onClick:()=>{S(null),k()},children:"إضافة ماركة"})]}),e?(0,i.jsx)(f.LoadingState,{message:"جاري تحميل الماركات..."}):0===y.length?(0,i.jsx)(f.EmptyState,{title:"لا توجد ماركات",message:"لم يتم العثور على ماركات. قم بإضافة ماركة جديدة."}):(0,i.jsx)(u.Paper,{radius:"md",withBorder:!0,style:{overflow:"hidden"},children:(0,i.jsxs)(t.Table,{striped:!0,highlightOnHover:!0,children:[(0,i.jsx)(t.Table.Thead,{children:(0,i.jsxs)(t.Table.Tr,{children:[(0,i.jsx)(t.Table.Th,{children:"الصورة"}),(0,i.jsx)(t.Table.Th,{children:"الاسم"}),(0,i.jsx)(t.Table.Th,{children:"الرابط"}),(0,i.jsx)(t.Table.Th,{children:"الوصف"}),(0,i.jsx)(t.Table.Th,{children:"الإجراءات"})]})}),(0,i.jsx)(t.Table.Tbody,{children:y.map(e=>(0,i.jsxs)(t.Table.Tr,{children:[(0,i.jsx)(t.Table.Td,{children:(0,i.jsx)(c.Image,{src:e.image||T.imageHelper.getPlaceholder(50,50),alt:e.name,width:50,height:50,radius:"sm",fallbackSrc:T.imageHelper.getPlaceholder(50,50)})}),(0,i.jsx)(t.Table.Td,{children:(0,i.jsx)(h.Text,{fw:500,children:e.name})}),(0,i.jsx)(t.Table.Td,{children:(0,i.jsxs)(h.Text,{size:"sm",c:"dimmed",dir:"ltr",children:["/",e.slug]})}),(0,i.jsx)(t.Table.Td,{children:(0,i.jsx)(h.Text,{size:"sm",lineClamp:1,children:e.description||"-"})}),(0,i.jsx)(t.Table.Td,{children:(0,i.jsxs)(d.Menu,{position:"bottom-end",withArrow:!0,children:[(0,i.jsx)(d.Menu.Target,{children:(0,i.jsx)(o.ActionIcon,{variant:"subtle",children:(0,i.jsx)(b.IconDotsVertical,{size:16})})}),(0,i.jsxs)(d.Menu.Dropdown,{children:[(0,i.jsx)(d.Menu.Item,{leftSection:(0,i.jsx)(p.IconPencil,{size:16}),onClick:()=>{S(e),k()},children:"تعديل"}),(0,i.jsx)(d.Menu.Item,{leftSection:(0,i.jsx)(j.IconTrash,{size:16}),color:"red",onClick:()=>{C(e),D()},children:"حذف"})]})]})})]},e.id))})]})})]}),(0,i.jsx)(B,{opened:P,onClose:A,brand:z,onSuccess:()=>{A(),V(),g.notifications.show({title:"تم الحفظ",message:z?"تم تحديث الماركة بنجاح":"تم إضافة الماركة بنجاح",color:"green"})}}),(0,i.jsx)(M.DeleteConfirmModal,{opened:E,onClose:F,onConfirm:G,title:"حذف الماركة",message:`هل أنت متأكد من حذف الماركة "${I?.name}"؟ لن يتم حذف العطور المرتبطة بها.`})]})}e.s(["default",()=>D],19528)}]);