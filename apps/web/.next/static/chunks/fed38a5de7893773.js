(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,66582,e=>{"use strict";var i=e.i(43476),s=e.i(71645),l=e.i(77936),r=e.i(92181),t=e.i(26200),n=e.i(33372),a=e.i(45288),o=e.i(73404),c=e.i(73990),d=e.i(5948),u=e.i(55150),h=e.i(94229),x=e.i(5142),g=e.i(53917),m=e.i(17708),j=e.i(57162),p=e.i(57662),T=e.i(48239);e.i(29499);var f=e.i(94108);e.i(6773);var b=e.i(64427),y=e.i(29277),v=e.i(25293),S=e.i(29895),w=e.i(44662),z=e.i(41638),I=e.i(2564),C=e.i(92859),P=e.i(37716),k=e.i(82819),A=e.i(57772);function E({opened:e,onClose:r,category:a,onSuccess:o}){let[d,u]=(0,s.useState)(!1),[x,g]=(0,s.useState)(null),[m,j]=(0,s.useState)(null),p=(0,z.useForm)({initialValues:{name:"",slug:"",description:"",image:""},validate:{name:e=>e.trim().length<2?"الاسم يجب أن يكون 2 أحرف على الأقل":null,slug:e=>e.trim().length<2?"الرابط يجب أن يكون 2 أحرف على الأقل":null}});(0,s.useEffect)(()=>{e&&(a?(p.setValues({name:a.name,slug:a.slug,description:a.description||"",image:a.image}),g(a.image)):(p.reset(),g(null)),j(null))},[e,a]);let T=async e=>{u(!0);try{let i,s="string"==typeof e.image?e.image:"";m&&(s=URL.createObjectURL(m));let l={name:e.name,slug:e.slug,description:e.description||void 0,image:s};(i=a?await f.categoryApi.update(a.id,l):await f.categoryApi.create(l)).success?o():console.error("Error saving category:",i.error)}catch(e){console.error("Error saving category:",e)}finally{u(!1)}};return(0,i.jsx)(y.Modal,{opened:e,onClose:r,title:a?"تعديل التصنيف":"إضافة تصنيف جديد",size:"lg",children:(0,i.jsx)("form",{onSubmit:p.onSubmit(T),children:(0,i.jsxs)(l.Stack,{gap:"md",children:[(0,i.jsxs)(w.Box,{children:[(0,i.jsx)(h.Text,{size:"sm",fw:500,mb:"xs",children:"صورة التصنيف"}),x?(0,i.jsxs)(w.Box,{pos:"relative",children:[(0,i.jsx)(c.Image,{src:x,alt:"Preview",height:150,radius:"md",fallbackSrc:f.imageHelper.getPlaceholder(400,150)}),(0,i.jsx)(n.Button,{variant:"filled",color:"red",size:"xs",pos:"absolute",top:10,right:10,onClick:()=>{g(null),j(null),p.setFieldValue("image","")},children:(0,i.jsx)(A.IconX,{size:16})})]}):(0,i.jsx)(I.Dropzone,{onDrop:e=>{if(e.length>0){let i=e[0];j(i),g(URL.createObjectURL(i))}},accept:C.IMAGE_MIME_TYPE,maxSize:5242880,multiple:!1,children:(0,i.jsxs)(t.Group,{justify:"center",gap:"xl",mih:120,style:{pointerEvents:"none"},children:[(0,i.jsx)(I.Dropzone.Accept,{children:(0,i.jsx)(P.IconUpload,{size:40,stroke:1.5})}),(0,i.jsx)(I.Dropzone.Reject,{children:(0,i.jsx)(A.IconX,{size:40,stroke:1.5})}),(0,i.jsx)(I.Dropzone.Idle,{children:(0,i.jsx)(k.IconPhoto,{size:40,stroke:1.5})}),(0,i.jsxs)("div",{children:[(0,i.jsx)(h.Text,{size:"md",inline:!0,children:"اسحب الصورة هنا أو اضغط للاختيار"}),(0,i.jsx)(h.Text,{size:"sm",c:"dimmed",inline:!0,mt:7,children:"الحد الأقصى للحجم 5MB"})]})]})})]}),(0,i.jsx)(v.TextInput,{label:"اسم التصنيف",placeholder:"أدخل اسم التصنيف",required:!0,value:p.values.name,onChange:e=>{var i;let s;return i=e.target.value,p.setFieldValue("name",i),void(!a&&p.setFieldValue("slug",(s={"عطور رجالية":"mens-perfumes","عطور نسائية":"womens-perfumes","عطور للجنسين":"unisex-perfumes","عطور عربية":"arabic-perfumes","عطور فرنسية":"french-perfumes","مجموعات هدايا":"gift-sets"})[i]?s[i]:i.toLowerCase().replace(/\s+/g,"-").replace(/[^\u0600-\u06FFa-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-|-$/g,"")))},error:p.errors.name}),(0,i.jsx)(v.TextInput,{label:"الرابط (Slug)",placeholder:"category-slug",description:"يستخدم في الروابط - سيتم إنشاؤه تلقائياً",required:!0,dir:"ltr",...p.getInputProps("slug")}),(0,i.jsx)(S.Textarea,{label:"الوصف",placeholder:"أدخل وصف التصنيف (اختياري)",minRows:2,...p.getInputProps("description")}),(0,i.jsxs)(t.Group,{justify:"flex-end",mt:"md",children:[(0,i.jsx)(n.Button,{variant:"light",onClick:r,children:"إلغاء"}),(0,i.jsx)(n.Button,{type:"submit",loading:d,children:a?"تحديث":"إضافة"})]})]})})})}var M=e.i(47215);function B(){let[e,y]=(0,s.useState)(!0),[v,S]=(0,s.useState)([]),[w,z]=(0,s.useState)(null),[I,C]=(0,s.useState)(null),[P,{open:k,close:A}]=(0,x.useDisclosure)(!1),[B,{open:D,close:R}]=(0,x.useDisclosure)(!1);(0,s.useEffect)(()=>{F()},[]);let F=async()=>{y(!0);try{let e=await f.categoryApi.getAll();e.success&&e.data&&S(e.data)}catch(e){console.error("Error loading categories:",e)}finally{y(!1)}},U=async()=>{if(I)try{let e=await f.categoryApi.delete(I.id);if(e.success)g.notifications.show({title:"تم الحذف",message:"تم حذف التصنيف بنجاح",color:"green"}),F();else throw Error(e.error)}catch(e){g.notifications.show({title:"خطأ",message:"حدث خطأ أثناء حذف التصنيف",color:"red"})}finally{R(),C(null)}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.Stack,{gap:"lg",children:[(0,i.jsxs)(t.Group,{justify:"space-between",children:[(0,i.jsx)(r.Title,{order:2,children:"إدارة التصنيفات"}),(0,i.jsx)(n.Button,{leftSection:(0,i.jsx)(m.IconPlus,{size:18}),onClick:()=>{z(null),k()},children:"إضافة تصنيف"})]}),e?(0,i.jsx)(b.LoadingState,{message:"جاري تحميل التصنيفات..."}):0===v.length?(0,i.jsx)(b.EmptyState,{title:"لا توجد تصنيفات",message:"لم يتم العثور على تصنيفات. قم بإضافة تصنيف جديد."}):(0,i.jsx)(u.Paper,{radius:"md",withBorder:!0,style:{overflow:"hidden"},children:(0,i.jsxs)(a.Table,{striped:!0,highlightOnHover:!0,children:[(0,i.jsx)(a.Table.Thead,{children:(0,i.jsxs)(a.Table.Tr,{children:[(0,i.jsx)(a.Table.Th,{children:"الصورة"}),(0,i.jsx)(a.Table.Th,{children:"الاسم"}),(0,i.jsx)(a.Table.Th,{children:"الرابط"}),(0,i.jsx)(a.Table.Th,{children:"الوصف"}),(0,i.jsx)(a.Table.Th,{children:"الإجراءات"})]})}),(0,i.jsx)(a.Table.Tbody,{children:v.map(e=>(0,i.jsxs)(a.Table.Tr,{children:[(0,i.jsx)(a.Table.Td,{children:(0,i.jsx)(c.Image,{src:e.image||f.imageHelper.getPlaceholder(50,50),alt:e.name,width:50,height:50,radius:"sm",fallbackSrc:f.imageHelper.getPlaceholder(50,50)})}),(0,i.jsx)(a.Table.Td,{children:(0,i.jsx)(h.Text,{fw:500,children:e.name})}),(0,i.jsx)(a.Table.Td,{children:(0,i.jsxs)(h.Text,{size:"sm",c:"dimmed",dir:"ltr",children:["/",e.slug]})}),(0,i.jsx)(a.Table.Td,{children:(0,i.jsx)(h.Text,{size:"sm",lineClamp:1,children:e.description||"-"})}),(0,i.jsx)(a.Table.Td,{children:(0,i.jsxs)(d.Menu,{position:"bottom-end",withArrow:!0,children:[(0,i.jsx)(d.Menu.Target,{children:(0,i.jsx)(o.ActionIcon,{variant:"subtle",children:(0,i.jsx)(T.IconDotsVertical,{size:16})})}),(0,i.jsxs)(d.Menu.Dropdown,{children:[(0,i.jsx)(d.Menu.Item,{leftSection:(0,i.jsx)(j.IconPencil,{size:16}),onClick:()=>{z(e),k()},children:"تعديل"}),(0,i.jsx)(d.Menu.Item,{leftSection:(0,i.jsx)(p.IconTrash,{size:16}),color:"red",onClick:()=>{C(e),D()},children:"حذف"})]})]})})]},e.id))})]})})]}),(0,i.jsx)(E,{opened:P,onClose:A,category:w,onSuccess:()=>{A(),F(),g.notifications.show({title:"تم الحفظ",message:w?"تم تحديث التصنيف بنجاح":"تم إضافة التصنيف بنجاح",color:"green"})}}),(0,i.jsx)(M.DeleteConfirmModal,{opened:B,onClose:R,onConfirm:U,title:"حذف التصنيف",message:`هل أنت متأكد من حذف "${I?.name}"؟ سيتم حذف التصنيف ولكن العطور المرتبطة به ستبقى بدون تصنيف.`})]})}e.s(["default",()=>B],66582)}]);