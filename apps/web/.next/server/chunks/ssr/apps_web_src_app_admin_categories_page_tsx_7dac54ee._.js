module.exports=[42127,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(1839),e=a.i(52466),f=a.i(51014),g=a.i(75949),h=a.i(18942),i=a.i(25042),j=a.i(90297),k=a.i(43490),l=a.i(64513),m=a.i(81577),n=a.i(87740),o=a.i(37678),p=a.i(17748),q=a.i(70987),r=a.i(99630),s=a.i(98977);a.i(15128);var t=a.i(69844);a.i(29110);var u=a.i(3877),v=a.i(19555),w=a.i(23413),x=a.i(44416),y=a.i(95667),z=a.i(9571),A=a.i(72909),B=a.i(55550),C=a.i(46533),D=a.i(20338),E=a.i(51519);function F({opened:a,onClose:e,category:h,onSuccess:i}){let[k,l]=(0,c.useState)(!1),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(null),r=(0,z.useForm)({initialValues:{name:"",slug:"",description:"",image:""},validate:{name:a=>a.trim().length<2?"الاسم يجب أن يكون 2 أحرف على الأقل":null,slug:a=>a.trim().length<2?"الرابط يجب أن يكون 2 أحرف على الأقل":null}});(0,c.useEffect)(()=>{a&&(h?(r.setValues({name:h.name,slug:h.slug,description:h.description||"",image:h.image}),o(h.image)):(r.reset(),o(null)),q(null))},[a,h]);let s=async a=>{l(!0);try{let b,c="string"==typeof a.image?a.image:"";p&&(c=URL.createObjectURL(p));let d={name:a.name,slug:a.slug,description:a.description||void 0,image:c};(b=h?await t.categoryApi.update(h.id,d):await t.categoryApi.create(d)).success?i():console.error("Error saving category:",b.error)}catch(a){console.error("Error saving category:",a)}finally{l(!1)}};return(0,b.jsx)(v.Modal,{opened:a,onClose:e,title:h?"تعديل التصنيف":"إضافة تصنيف جديد",size:"lg",children:(0,b.jsx)("form",{onSubmit:r.onSubmit(s),children:(0,b.jsxs)(d.Stack,{gap:"md",children:[(0,b.jsxs)(y.Box,{children:[(0,b.jsx)(m.Text,{size:"sm",fw:500,mb:"xs",children:"صورة التصنيف"}),n?(0,b.jsxs)(y.Box,{pos:"relative",children:[(0,b.jsx)(j.Image,{src:n,alt:"Preview",height:150,radius:"md",fallbackSrc:t.imageHelper.getPlaceholder(400,150)}),(0,b.jsx)(g.Button,{variant:"filled",color:"red",size:"xs",pos:"absolute",top:10,right:10,onClick:()=>{o(null),q(null),r.setFieldValue("image","")},children:(0,b.jsx)(E.IconX,{size:16})})]}):(0,b.jsx)(A.Dropzone,{onDrop:a=>{if(a.length>0){let b=a[0];q(b),o(URL.createObjectURL(b))}},accept:B.IMAGE_MIME_TYPE,maxSize:5242880,multiple:!1,children:(0,b.jsxs)(f.Group,{justify:"center",gap:"xl",mih:120,style:{pointerEvents:"none"},children:[(0,b.jsx)(A.Dropzone.Accept,{children:(0,b.jsx)(C.IconUpload,{size:40,stroke:1.5})}),(0,b.jsx)(A.Dropzone.Reject,{children:(0,b.jsx)(E.IconX,{size:40,stroke:1.5})}),(0,b.jsx)(A.Dropzone.Idle,{children:(0,b.jsx)(D.IconPhoto,{size:40,stroke:1.5})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Text,{size:"md",inline:!0,children:"اسحب الصورة هنا أو اضغط للاختيار"}),(0,b.jsx)(m.Text,{size:"sm",c:"dimmed",inline:!0,mt:7,children:"الحد الأقصى للحجم 5MB"})]})]})})]}),(0,b.jsx)(w.TextInput,{label:"اسم التصنيف",placeholder:"أدخل اسم التصنيف",required:!0,value:r.values.name,onChange:a=>{var b;let c;return b=a.target.value,r.setFieldValue("name",b),void(!h&&r.setFieldValue("slug",(c={"عطور رجالية":"mens-perfumes","عطور نسائية":"womens-perfumes","عطور للجنسين":"unisex-perfumes","عطور عربية":"arabic-perfumes","عطور فرنسية":"french-perfumes","مجموعات هدايا":"gift-sets"})[b]?c[b]:b.toLowerCase().replace(/\s+/g,"-").replace(/[^\u0600-\u06FFa-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-|-$/g,"")))},error:r.errors.name}),(0,b.jsx)(w.TextInput,{label:"الرابط (Slug)",placeholder:"category-slug",description:"يستخدم في الروابط - سيتم إنشاؤه تلقائياً",required:!0,dir:"ltr",...r.getInputProps("slug")}),(0,b.jsx)(x.Textarea,{label:"الوصف",placeholder:"أدخل وصف التصنيف (اختياري)",minRows:2,...r.getInputProps("description")}),(0,b.jsxs)(f.Group,{justify:"flex-end",mt:"md",children:[(0,b.jsx)(g.Button,{variant:"light",onClick:e,children:"إلغاء"}),(0,b.jsx)(g.Button,{type:"submit",loading:k,children:h?"تحديث":"إضافة"})]})]})})})}var G=a.i(79290);function H(){let[a,v]=(0,c.useState)(!0),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(null),[C,{open:D,close:E}]=(0,n.useDisclosure)(!1),[H,{open:I,close:J}]=(0,n.useDisclosure)(!1);(0,c.useEffect)(()=>{K()},[]);let K=async()=>{v(!0);try{let a=await t.categoryApi.getAll();a.success&&a.data&&x(a.data)}catch(a){console.error("Error loading categories:",a)}finally{v(!1)}},L=async()=>{if(A)try{let a=await t.categoryApi.delete(A.id);if(a.success)o.notifications.show({title:"تم الحذف",message:"تم حذف التصنيف بنجاح",color:"green"}),K();else throw Error(a.error)}catch(a){o.notifications.show({title:"خطأ",message:"حدث خطأ أثناء حذف التصنيف",color:"red"})}finally{J(),B(null)}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(d.Stack,{gap:"lg",children:[(0,b.jsxs)(f.Group,{justify:"space-between",children:[(0,b.jsx)(e.Title,{order:2,children:"إدارة التصنيفات"}),(0,b.jsx)(g.Button,{leftSection:(0,b.jsx)(p.IconPlus,{size:18}),onClick:()=>{z(null),D()},children:"إضافة تصنيف"})]}),a?(0,b.jsx)(u.LoadingState,{message:"جاري تحميل التصنيفات..."}):0===w.length?(0,b.jsx)(u.EmptyState,{title:"لا توجد تصنيفات",message:"لم يتم العثور على تصنيفات. قم بإضافة تصنيف جديد."}):(0,b.jsx)(l.Paper,{radius:"md",withBorder:!0,style:{overflow:"hidden"},children:(0,b.jsxs)(h.Table,{striped:!0,highlightOnHover:!0,children:[(0,b.jsx)(h.Table.Thead,{children:(0,b.jsxs)(h.Table.Tr,{children:[(0,b.jsx)(h.Table.Th,{children:"الصورة"}),(0,b.jsx)(h.Table.Th,{children:"الاسم"}),(0,b.jsx)(h.Table.Th,{children:"الرابط"}),(0,b.jsx)(h.Table.Th,{children:"الوصف"}),(0,b.jsx)(h.Table.Th,{children:"الإجراءات"})]})}),(0,b.jsx)(h.Table.Tbody,{children:w.map(a=>(0,b.jsxs)(h.Table.Tr,{children:[(0,b.jsx)(h.Table.Td,{children:(0,b.jsx)(j.Image,{src:a.image||t.imageHelper.getPlaceholder(50,50),alt:a.name,width:50,height:50,radius:"sm",fallbackSrc:t.imageHelper.getPlaceholder(50,50)})}),(0,b.jsx)(h.Table.Td,{children:(0,b.jsx)(m.Text,{fw:500,children:a.name})}),(0,b.jsx)(h.Table.Td,{children:(0,b.jsxs)(m.Text,{size:"sm",c:"dimmed",dir:"ltr",children:["/",a.slug]})}),(0,b.jsx)(h.Table.Td,{children:(0,b.jsx)(m.Text,{size:"sm",lineClamp:1,children:a.description||"-"})}),(0,b.jsx)(h.Table.Td,{children:(0,b.jsxs)(k.Menu,{position:"bottom-end",withArrow:!0,children:[(0,b.jsx)(k.Menu.Target,{children:(0,b.jsx)(i.ActionIcon,{variant:"subtle",children:(0,b.jsx)(s.IconDotsVertical,{size:16})})}),(0,b.jsxs)(k.Menu.Dropdown,{children:[(0,b.jsx)(k.Menu.Item,{leftSection:(0,b.jsx)(q.IconPencil,{size:16}),onClick:()=>{z(a),D()},children:"تعديل"}),(0,b.jsx)(k.Menu.Item,{leftSection:(0,b.jsx)(r.IconTrash,{size:16}),color:"red",onClick:()=>{B(a),I()},children:"حذف"})]})]})})]},a.id))})]})})]}),(0,b.jsx)(F,{opened:C,onClose:E,category:y,onSuccess:()=>{E(),K(),o.notifications.show({title:"تم الحفظ",message:y?"تم تحديث التصنيف بنجاح":"تم إضافة التصنيف بنجاح",color:"green"})}}),(0,b.jsx)(G.DeleteConfirmModal,{opened:H,onClose:J,onConfirm:L,title:"حذف التصنيف",message:`هل أنت متأكد من حذف "${A?.name}"؟ سيتم حذف التصنيف ولكن العطور المرتبطة به ستبقى بدون تصنيف.`})]})}a.s(["default",()=>H],42127)}];

//# sourceMappingURL=apps_web_src_app_admin_categories_page_tsx_7dac54ee._.js.map