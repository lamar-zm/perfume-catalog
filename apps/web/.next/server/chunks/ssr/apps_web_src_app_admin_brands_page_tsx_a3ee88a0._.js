module.exports=[60395,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(1839),e=a.i(52466),f=a.i(51014),g=a.i(75949),h=a.i(18942),i=a.i(25042),j=a.i(90297),k=a.i(43490),l=a.i(64513),m=a.i(81577),n=a.i(87740),o=a.i(37678),p=a.i(17748),q=a.i(70987),r=a.i(99630),s=a.i(98977);a.i(15128);var t=a.i(69844);a.i(29110);var u=a.i(3877),v=a.i(19555),w=a.i(23413),x=a.i(44416),y=a.i(95667),z=a.i(11364),A=a.i(9571),B=a.i(72909),C=a.i(55550),D=a.i(46533),E=a.i(20338),F=a.i(51519);function G({opened:a,onClose:e,brand:h,onSuccess:i}){let[k,l]=(0,c.useState)(!1),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(null),r=(0,A.useForm)({initialValues:{name:"",slug:"",description:"",image:""},validate:{name:a=>a.trim().length<2?"الاسم يجب أن يكون 2 أحرف على الأقل":null,slug:a=>a.trim().length<2?"الرابط يجب أن يكون 2 أحرف على الأقل":null}});(0,c.useEffect)(()=>{a&&(h?(r.setValues({name:h.name,slug:h.slug,description:h.description||"",image:h.image||""}),q(h.image||null)):(r.reset(),q(null)))},[a,h]);let s=async a=>{if(a.length>0){let b=a[0];o(!0);try{let a=await t.uploadApi.upload(b);a.success&&a.data?(r.setFieldValue("image",a.data.url),q(a.data.url)):console.error("Upload failed:",a.error)}catch(a){console.error("Error uploading image:",a)}finally{o(!1)}}},u=async()=>{let a=r.values.image;if(a&&a.startsWith("/uploads/"))try{await t.uploadApi.delete(a)}catch(a){console.error("Error deleting image:",a)}q(null),r.setFieldValue("image","")},G=async a=>{l(!0);try{let b,c={name:a.name,slug:a.slug,description:a.description||void 0,image:a.image||""};(b=h?await t.brandApi.update(h.id,c):await t.brandApi.create(c)).success?i():console.error("Error saving brand:",b.error)}catch(a){console.error("Error saving brand:",a)}finally{l(!1)}};return(0,b.jsx)(v.Modal,{opened:a,onClose:e,title:h?"تعديل الماركة":"إضافة ماركة جديدة",size:"lg",children:(0,b.jsxs)(y.Box,{pos:"relative",children:[(0,b.jsx)(z.LoadingOverlay,{visible:n,zIndex:1e3,overlayProps:{blur:2}}),(0,b.jsx)("form",{onSubmit:r.onSubmit(G),children:(0,b.jsxs)(d.Stack,{gap:"md",children:[(0,b.jsxs)(y.Box,{children:[(0,b.jsx)(m.Text,{size:"sm",fw:500,mb:"xs",children:"صورة الماركة"}),p?(0,b.jsxs)(y.Box,{pos:"relative",children:[(0,b.jsx)(j.Image,{src:p,alt:"Preview",height:150,radius:"md",fallbackSrc:t.imageHelper.getPlaceholder(400,150)}),(0,b.jsx)(g.Button,{variant:"filled",color:"red",size:"xs",pos:"absolute",top:10,right:10,onClick:u,children:(0,b.jsx)(F.IconX,{size:16})})]}):(0,b.jsx)(B.Dropzone,{onDrop:s,accept:C.IMAGE_MIME_TYPE,maxSize:0xa00000,multiple:!1,loading:n,children:(0,b.jsxs)(f.Group,{justify:"center",gap:"xl",mih:120,style:{pointerEvents:"none"},children:[(0,b.jsx)(B.Dropzone.Accept,{children:(0,b.jsx)(D.IconUpload,{size:40,stroke:1.5})}),(0,b.jsx)(B.Dropzone.Reject,{children:(0,b.jsx)(F.IconX,{size:40,stroke:1.5})}),(0,b.jsx)(B.Dropzone.Idle,{children:(0,b.jsx)(E.IconPhoto,{size:40,stroke:1.5})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(m.Text,{size:"md",inline:!0,children:"اسحب الصورة هنا أو اضغط للاختيار"}),(0,b.jsx)(m.Text,{size:"sm",c:"dimmed",inline:!0,mt:7,children:"الحد الأقصى للحجم 10MB"})]})]})})]}),(0,b.jsx)(w.TextInput,{label:"اسم الماركة",placeholder:"أدخل اسم الماركة",required:!0,value:r.values.name,onChange:a=>{var b;let c;return b=a.target.value,r.setFieldValue("name",b),void(!h&&r.setFieldValue("slug",(c={شانيل:"chanel",ديور:"dior",قوتشي:"gucci",برادا:"prada",فيرساتشي:"versace",أرماني:"armani",جيفنشي:"givenchy",بولغاري:"bvlgari",هيرميس:"hermes","توم فورد":"tom-ford","كريستيان ديور":"christian-dior","ايف سان لوران":"yves-saint-laurent","كارولينا هيريرا":"carolina-herrera","جورجيو أرماني":"giorgio-armani","دولتشي آند غابانا":"dolce-gabbana","كالفن كلاين":"calvin-klein","هوغو بوس":"hugo-boss",عجمل:"ajmal","العربية للعود":"arabian-oud",رسايس:"rasasi","سويس أريبيان":"swiss-arabian",لطافة:"lattafa"})[b]?c[b]:b.toLowerCase().replace(/\s+/g,"-").replace(/[^\u0600-\u06FFa-z0-9-]/g,"").replace(/-+/g,"-").replace(/^-|-$/g,"")))},error:r.errors.name}),(0,b.jsx)(w.TextInput,{label:"الرابط (Slug)",placeholder:"brand-slug",description:"يستخدم في الروابط - سيتم إنشاؤه تلقائياً",required:!0,dir:"ltr",...r.getInputProps("slug")}),(0,b.jsx)(x.Textarea,{label:"الوصف",placeholder:"أدخل وصف الماركة (اختياري)",minRows:2,...r.getInputProps("description")}),(0,b.jsxs)(f.Group,{justify:"flex-end",mt:"md",children:[(0,b.jsx)(g.Button,{variant:"light",onClick:e,children:"إلغاء"}),(0,b.jsx)(g.Button,{type:"submit",loading:k,children:h?"تحديث":"إضافة"})]})]})})]})})}var H=a.i(79290);function I(){let[a,v]=(0,c.useState)(!0),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(null),[C,{open:D,close:E}]=(0,n.useDisclosure)(!1),[F,{open:I,close:J}]=(0,n.useDisclosure)(!1);(0,c.useEffect)(()=>{K()},[]);let K=async()=>{v(!0);try{let a=await t.brandApi.getAll();a.success&&a.data&&x(a.data)}catch(a){console.error("Error loading brands:",a)}finally{v(!1)}},L=async()=>{if(A)try{let a=await t.brandApi.delete(A.id);if(a.success)o.notifications.show({title:"تم الحذف",message:"تم حذف الماركة بنجاح",color:"green"}),K();else throw Error(a.error)}catch(a){o.notifications.show({title:"خطأ",message:"حدث خطأ أثناء حذف الماركة",color:"red"})}finally{J(),B(null)}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(d.Stack,{gap:"lg",children:[(0,b.jsxs)(f.Group,{justify:"space-between",children:[(0,b.jsx)(e.Title,{order:2,children:"إدارة الماركات"}),(0,b.jsx)(g.Button,{leftSection:(0,b.jsx)(p.IconPlus,{size:18}),onClick:()=>{z(null),D()},children:"إضافة ماركة"})]}),a?(0,b.jsx)(u.LoadingState,{message:"جاري تحميل الماركات..."}):0===w.length?(0,b.jsx)(u.EmptyState,{title:"لا توجد ماركات",message:"لم يتم العثور على ماركات. قم بإضافة ماركة جديدة."}):(0,b.jsx)(l.Paper,{radius:"md",withBorder:!0,style:{overflow:"hidden"},children:(0,b.jsxs)(h.Table,{striped:!0,highlightOnHover:!0,children:[(0,b.jsx)(h.Table.Thead,{children:(0,b.jsxs)(h.Table.Tr,{children:[(0,b.jsx)(h.Table.Th,{children:"الصورة"}),(0,b.jsx)(h.Table.Th,{children:"الاسم"}),(0,b.jsx)(h.Table.Th,{children:"الرابط"}),(0,b.jsx)(h.Table.Th,{children:"الوصف"}),(0,b.jsx)(h.Table.Th,{children:"الإجراءات"})]})}),(0,b.jsx)(h.Table.Tbody,{children:w.map(a=>(0,b.jsxs)(h.Table.Tr,{children:[(0,b.jsx)(h.Table.Td,{children:(0,b.jsx)(j.Image,{src:a.image||t.imageHelper.getPlaceholder(50,50),alt:a.name,width:50,height:50,radius:"sm",fallbackSrc:t.imageHelper.getPlaceholder(50,50)})}),(0,b.jsx)(h.Table.Td,{children:(0,b.jsx)(m.Text,{fw:500,children:a.name})}),(0,b.jsx)(h.Table.Td,{children:(0,b.jsxs)(m.Text,{size:"sm",c:"dimmed",dir:"ltr",children:["/",a.slug]})}),(0,b.jsx)(h.Table.Td,{children:(0,b.jsx)(m.Text,{size:"sm",lineClamp:1,children:a.description||"-"})}),(0,b.jsx)(h.Table.Td,{children:(0,b.jsxs)(k.Menu,{position:"bottom-end",withArrow:!0,children:[(0,b.jsx)(k.Menu.Target,{children:(0,b.jsx)(i.ActionIcon,{variant:"subtle",children:(0,b.jsx)(s.IconDotsVertical,{size:16})})}),(0,b.jsxs)(k.Menu.Dropdown,{children:[(0,b.jsx)(k.Menu.Item,{leftSection:(0,b.jsx)(q.IconPencil,{size:16}),onClick:()=>{z(a),D()},children:"تعديل"}),(0,b.jsx)(k.Menu.Item,{leftSection:(0,b.jsx)(r.IconTrash,{size:16}),color:"red",onClick:()=>{B(a),I()},children:"حذف"})]})]})})]},a.id))})]})})]}),(0,b.jsx)(G,{opened:C,onClose:E,brand:y,onSuccess:()=>{E(),K(),o.notifications.show({title:"تم الحفظ",message:y?"تم تحديث الماركة بنجاح":"تم إضافة الماركة بنجاح",color:"green"})}}),(0,b.jsx)(H.DeleteConfirmModal,{opened:F,onClose:J,onConfirm:L,title:"حذف الماركة",message:`هل أنت متأكد من حذف الماركة "${A?.name}"؟ لن يتم حذف العطور المرتبطة بها.`})]})}a.s(["default",()=>I],60395)}];

//# sourceMappingURL=apps_web_src_app_admin_brands_page_tsx_a3ee88a0._.js.map