module.exports=[5625,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(1839),e=a.i(52466),f=a.i(18942),g=a.i(25042),h=a.i(18103),i=a.i(90297),j=a.i(64513),k=a.i(81577),l=a.i(54165),m=a.i(51014),n=a.i(75949),o=a.i(37678);let p=(0,a.i(49862).default)("outline","check","Check",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]);var q=a.i(51519);a.i(15128);var r=a.i(69844);a.i(29110);var s=a.i(3877);function t(){let[a,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(null);(0,c.useEffect)(()=>{C()},[]);let C=async()=>{t(!0);try{let[a,b,c]=await Promise.all([r.perfumeApi.getDiscounted(),r.perfumeApi.getAll({page:1,pageSize:100}),r.categoryApi.getAll()]);v(a.success&&a.data?a.data:[]),x(b.success&&b.data&&b.data.data?b.data.data:[]),z(c.success&&c.data?c.data:[])}catch(a){console.error("Error loading data:",a)}finally{t(!1)}},D=async(a,b)=>{try{let c=await r.perfumeApi.update(a,{discount:b});if(c.success)C(),B(null),o.notifications.show({title:"تم التحديث",message:b?"تم تحديث الخصم بنجاح":"تم إزالة الخصم",color:"green"});else throw Error(c.error)}catch(a){o.notifications.show({title:"خطأ",message:"حدث خطأ أثناء تحديث الخصم",color:"red"})}},E=async a=>{await D(a,void 0)},F=w.filter(a=>!a.discount||0===a.discount);return a?(0,b.jsx)(s.LoadingState,{message:"جاري تحميل البيانات..."}):(0,b.jsxs)(d.Stack,{gap:"xl",children:[(0,b.jsx)(e.Title,{order:2,children:"إدارة التخفيضات"}),(0,b.jsxs)(j.Paper,{p:"md",radius:"md",withBorder:!0,children:[(0,b.jsxs)(m.Group,{justify:"space-between",mb:"md",children:[(0,b.jsx)(e.Title,{order:4,children:"عطور بتخفيضات نشطة"}),(0,b.jsxs)(h.Badge,{size:"lg",variant:"light",color:"red",children:[u.length," عطر"]})]}),0===u.length?(0,b.jsx)(s.EmptyState,{title:"لا توجد تخفيضات",message:"قم بإضافة تخفيضات للعطور من الجدول أدناه"}):(0,b.jsxs)(f.Table,{striped:!0,highlightOnHover:!0,children:[(0,b.jsx)(f.Table.Thead,{children:(0,b.jsxs)(f.Table.Tr,{children:[(0,b.jsx)(f.Table.Th,{children:"الصورة"}),(0,b.jsx)(f.Table.Th,{children:"العطر"}),(0,b.jsx)(f.Table.Th,{children:"السعر الأصلي"}),(0,b.jsx)(f.Table.Th,{children:"الخصم"}),(0,b.jsx)(f.Table.Th,{children:"السعر النهائي"}),(0,b.jsx)(f.Table.Th,{children:"الإجراءات"})]})}),(0,b.jsx)(f.Table.Tbody,{children:u.map(a=>(0,b.jsxs)(f.Table.Tr,{children:[(0,b.jsx)(f.Table.Td,{children:(0,b.jsx)(i.Image,{src:a.coverImage||a.images?.[0]||r.imageHelper.getPlaceholder(50,50),alt:a.title,width:50,height:50,radius:"sm",fallbackSrc:r.imageHelper.getPlaceholder(50,50)})}),(0,b.jsx)(f.Table.Td,{children:(0,b.jsx)(k.Text,{fw:500,children:a.title})}),(0,b.jsxs)(f.Table.Td,{children:[a.price," د.ع"]}),(0,b.jsx)(f.Table.Td,{children:A?.id===a.id?(0,b.jsxs)(m.Group,{gap:"xs",children:[(0,b.jsx)(l.NumberInput,{value:A.value,onChange:b=>B({id:a.id,value:Number(b)||0}),min:0,max:a.price-1,size:"xs",style:{width:80}}),(0,b.jsx)(g.ActionIcon,{color:"green",size:"sm",onClick:()=>D(a.id,A.value),children:(0,b.jsx)(p,{size:14})}),(0,b.jsx)(g.ActionIcon,{color:"gray",size:"sm",onClick:()=>B(null),children:(0,b.jsx)(q.IconX,{size:14})})]}):(0,b.jsxs)(h.Badge,{color:"red",variant:"light",style:{cursor:"pointer"},onClick:()=>B({id:a.id,value:a.discount||0}),children:["-",a.discount," دينار"]})}),(0,b.jsx)(f.Table.Td,{children:(0,b.jsxs)(k.Text,{fw:600,c:"green",children:[a.price-(a.discount||0)," د.ع"]})}),(0,b.jsx)(f.Table.Td,{children:(0,b.jsx)(n.Button,{variant:"light",color:"red",size:"xs",onClick:()=>E(a.id),children:"إزالة الخصم"})})]},a.id))})]})]}),(0,b.jsxs)(j.Paper,{p:"md",radius:"md",withBorder:!0,children:[(0,b.jsxs)(m.Group,{justify:"space-between",mb:"md",children:[(0,b.jsx)(e.Title,{order:4,children:"عطور بدون تخفيض"}),(0,b.jsxs)(h.Badge,{size:"lg",variant:"light",color:"gray",children:[F.length," عطر"]})]}),0===F.length?(0,b.jsx)(k.Text,{c:"dimmed",ta:"center",py:"md",children:"جميع العطور لديها تخفيضات"}):(0,b.jsxs)(f.Table,{striped:!0,highlightOnHover:!0,children:[(0,b.jsx)(f.Table.Thead,{children:(0,b.jsxs)(f.Table.Tr,{children:[(0,b.jsx)(f.Table.Th,{children:"الصورة"}),(0,b.jsx)(f.Table.Th,{children:"العطر"}),(0,b.jsx)(f.Table.Th,{children:"التصنيف"}),(0,b.jsx)(f.Table.Th,{children:"السعر"}),(0,b.jsx)(f.Table.Th,{children:"إضافة خصم"})]})}),(0,b.jsx)(f.Table.Tbody,{children:F.map(a=>{var c;return(0,b.jsxs)(f.Table.Tr,{children:[(0,b.jsx)(f.Table.Td,{children:(0,b.jsx)(i.Image,{src:a.coverImage||a.images?.[0]||r.imageHelper.getPlaceholder(50,50),alt:a.title,width:50,height:50,radius:"sm",fallbackSrc:r.imageHelper.getPlaceholder(50,50)})}),(0,b.jsx)(f.Table.Td,{children:(0,b.jsx)(k.Text,{fw:500,children:a.title})}),(0,b.jsx)(f.Table.Td,{children:(c=a.categoryId)&&y.find(a=>a.id===c)?.name||"-"}),(0,b.jsxs)(f.Table.Td,{children:[a.price," د.ع"]}),(0,b.jsx)(f.Table.Td,{children:A?.id===a.id?(0,b.jsxs)(m.Group,{gap:"xs",children:[(0,b.jsx)(l.NumberInput,{value:A.value,onChange:b=>B({id:a.id,value:Number(b)||0}),min:1,max:a.price-1,placeholder:"الخصم",size:"xs",style:{width:80}}),(0,b.jsx)(g.ActionIcon,{color:"green",size:"sm",onClick:()=>D(a.id,A.value),disabled:A.value<=0,children:(0,b.jsx)(p,{size:14})}),(0,b.jsx)(g.ActionIcon,{color:"gray",size:"sm",onClick:()=>B(null),children:(0,b.jsx)(q.IconX,{size:14})})]}):(0,b.jsx)(n.Button,{variant:"light",size:"xs",onClick:()=>B({id:a.id,value:0}),children:"إضافة خصم"})})]},a.id)})})]})]})]})}a.s(["default",()=>t],5625)}];

//# sourceMappingURL=apps_web_src_app_admin_discounts_page_tsx_00fe464e._.js.map